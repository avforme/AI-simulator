#!/usr/bin/env python3

# AIPlanner - Deep Learning Financial Planner
# Copyright (C) 2018 Gordon Irlam
#
# All rights reserved. This program may not be used, copied, modified,
# or redistributed without permission.
#
# This program is distributed WITHOUT ANY WARRANTY; without even the
# implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
# PURPOSE.

from argparse import ArgumentParser
from math import exp

from yield_curve import YieldCurve

parser = ArgumentParser()
parser.add_argument('-t', '--type', choices=('corporate', 'nominal', 'real'), required=True)
parser.add_argument('-s', '--start', default = '2005-01-01')
parser.add_argument('-e', '--end', default = '2017-12-31')
args = parser.parse_args()

name = 'special-average-' + args.start + '-' + args.end

yield_curve = YieldCurve(args.type, args.end, date_str_low = args.start)

maturity = tuple(i / 2 for i in range(1, 200 + 1))
spots = tuple(2 * (exp(yield_curve.spot(y) / 2) - 1) for y in maturity)
    # Treasury par rates are twice the semi-annual rate.

# Reported par rates won't match the input par rates because yield
# curve forward rates are effectively interpolated using the
# PchipInterpolator to produce spots, but then the spots' forward
# rates are interpolated at the quoted maturities using monotone
# convex. The spot rate sequences will however match.

print('# RCMT yield curve generated by gen_yield_curve_special.')
print('DATE,' + ','.join(tuple(str(y) for y in maturity)))
print(name + ',' + ','.join(str(r * 100) for r in yield_curve.spot_to_par(spots)))
