#!/bin/bash

# AIPlanner - Deep Learning Financial Planner
# Copyright (C) 2018 Gordon Irlam
#
# All rights reserved. This program may not be used, copied, modified,
# or redistributed without permission.
#
# This program is distributed WITHOUT ANY WARRANTY; without even the
# implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
# PURPOSE.

AIPLANNER_HOME=${AIPLANNER_HOME:-$HOME/aiplanner}
EVAL_TIMESTEPS=${EVAL_TIMESTEPS:-4000000} # 4000000 is observed to result in an approximately 0.1% CE standard error.

AI_DIR=$AIPLANNER_HOME/ai
PYTHONPATH_ADD=$AI_DIR/baselines:$AI_DIR/gym-fin:$AIPLANNER_HOME/spia
if [ -z "$PYTHONPATH" ]; then
    export PYTHONPATH=$PYTHONPATH_ADD
else
    export PYTHONPATH=$PYTHONPATH_ADD:$PYTHONPATH
fi

validate () {

    MODEL_NAME=$1
    MODE=$2
    ARGS=$3

    MODEL_DIR=run.$MODEL_NAME.$MODE
    mkdir -p $MODEL_DIR
    $AI_DIR/run_model.py --$MODE $ARGS --eval-num-timesteps=$EVAL_TIMESTEPS 2>&1 | tee $MODEL_DIR/eval.log
}

validate fixed_30-gi_0-p_300000 merton '--master-guaranteed-income=0 --master-p-notax=300000'
validate fixed_30-gi_0-p_300000 samuelson '--master-guaranteed-income=0 --master-p-notax=300000'
