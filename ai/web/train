#!/bin/bash

# AIPlanner - Deep Learning Financial Planner
# Copyright (C) 2018 Gordon Irlam
#
# All rights reserved. This program may not be used, copied, modified,
# or redistributed without permission.
#
# This program is distributed WITHOUT ANY WARRANTY; without even the
# implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
# PURPOSE.

AIPLANNER_HOME=${AIPLANNER_HOME:-$HOME/aiplanner}

source $AIPLANNER_HOME/ai/helpers.bash

PARALEL=Jobs

GAMMAS="6 3 1.5 1"

for GAMMA in $GAMMAS; do
    train single-no_spias-gamma$GAMMA "--gamma=$GAMMA"
done
wait

for GAMMA in $GAMMAS; do
    train single-spias-gamma$GAMMA "--master-nominal-spias --gamma=$GAMMA"
done
wait

for GAMMA in $GAMMAS; do
    train couple-no_spias-gamma$GAMMA "--master-sex2=male --gamma=$GAMMA"
done
wait

for GAMMA in $GAMMAS; do
    train couple-spias-gamma$GAMMA "--master-sex2=male --master-nominal-spias --gamma=$GAMMA"
done
wait

# For evaluations use something similar to the follow (use 5e5 amounts for single):
#
# train couple-spias '--master-sex2=male --master-nominal-spias'
# PARALLEL=Jobs
# evaluate couple-spias age_start50-defined_benefits16e3-tax_free1e6 "-c $COUPLE_EVAL_FILE --master-p-tax-free=1e6 --master-nominal-spias"
# evaluate couple-spias age_start50-defined_benefits16e3-tax_deferred1e6 "-c $COUPLE_EVAL_FILE --master-p-tax-deferred=1e6 --master-nominal-spias"
# evaluate couple-spias age_start50-defined_benefits16e3-taxable_stocks1e6 "-c $COUPLE_EVAL_FILE --master-p-taxable-stocks=1e6 --master-nominal-spias"
# evaluate couple-spias retired65-defined_benefits16e3-tax_free1e6 "-c $COUPLE_EVAL_FILE --master-age-start=65 --master-p-tax-free=1e6 --master-nominal-spias"
# wait
#
# for i in age*tax_free* age*tax_def* age*taxable* retired*; do echo ==== $i ====; for j in aiplanner.couple-spias-timesteps_2m_2m*seed_0*; do echo $j; ../best_eval `echo $j | sed s/0/*/`/$i | head -1; done; done
#
# And take an average of the resulting CE ratios.

# Notes on tweaks that have been tried out:
#
# --master-nominal-spias --train-single-num-timesteps=1000000
#    Produced 2.1% worse generic results than 2m timesteps.
#
# --master-nominal-spias --train-single-num-timesteps=5000000
#    Produced 0.8% worse generic results than 2m timesteps.
#
# --master-nominal-spias --train-single-num-timesteps=2000000 --hidden-layer-size=128
#    Produced 3.0% worse generic results than size 64.
#
# --master-sex2=male --master-nominal-spias --train-num-timesteps=2000000
#    Produced 3.0% worse generic results than --train-single-num-timesteps=2000000 --train-couple-num-timesteps=2000000
#
# --master-sex2=male --master-nominal-spias --train-single-num-timesteps=2000000 --train-couple-num-timesteps=2000000 --no-train-couple-net
#    Produced 10.3% worse generic results than the default, --train-couple-net.
#
# --master-sex2=male --master-nominal-spias --train-single-num-timesteps=2000000 --train-couple-num-timesteps=2000000 --master-gamma=3
#    Produced 8.4% worse generic results than variable gamma.
#
# --master-sex2=male --master-nominal-spias --train-single-num-timesteps=2000000 --train-couple-num-timesteps=2000000 --master-nomal-bonds-duration=15
#    Produced 3.4% better generic results than variable bonds duration.
#
# --master-sex2=male --master-nominal-spias --train-single-num-timesteps=5000000 --train-couple-num-timesteps=5000000
#    Not tried.
